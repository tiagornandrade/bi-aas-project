2025-02-21 18:31:09,163 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'database.duckdb'} (connection.py:309)
2025-02-21 18:31:09,446 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: database.duckdb (connection.py:305)
2025-02-21 18:31:12,109 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema database.sqlmesh__main (evaluator.py:322)
2025-02-21 18:31:12,110 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2087)
2025-02-21 18:31:12,111 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2087)
2025-02-21 18:31:12,114 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'database' AND table_schema = 'sqlmesh__main') AND table_name IN ('main__raw_accounts__3546263750__dev', 'main__raw_accounts__3546263750') (base.py:2087)
2025-02-21 18:31:12,145 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'database.sqlmesh__main' (evaluator.py:1060)
2025-02-21 18:31:12,146 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "database"."sqlmesh__main" (base.py:2087)
2025-02-21 18:31:12,149 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'database.sqlmesh__main.main__raw_accounts__3546263750__dev' (evaluator.py:1402)
2025-02-21 18:31:12,150 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "database"."sqlmesh__main"."main__raw_accounts__3546263750__dev" AS SELECT "account_id" AS "account_id", "account_type" AS "account_type", "balance" AS "balance", "currency" AS "currency", "status" AS "status", "user_id" AS "user_id", "created_at" AS "created_at" FROM "database"."main"."accounts" AS "accounts" WHERE FALSE LIMIT 0 (base.py:2087)
2025-02-21 18:31:12,166 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"database"."main"."raw_accounts": 4252167850> (evaluator.py:594)
2025-02-21 18:31:12,168 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-02-20 00:00:00, 2025-02-21 00:00:00) into database.sqlmesh__main.main__raw_accounts__3546263750' (evaluator.py:648)
2025-02-21 18:31:12,169 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "database"."sqlmesh__main"."main__raw_accounts__3546263750" (base.py:2087)
2025-02-21 18:31:12,171 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "database"."sqlmesh__main"."main__raw_accounts__3546263750" AS SELECT CAST("account_id" AS TEXT) AS "account_id", CAST("account_type" AS TEXT) AS "account_type", CAST("balance" AS INT) AS "balance", CAST("currency" AS TEXT) AS "currency", CAST("status" AS TEXT) AS "status", CAST("user_id" AS TEXT) AS "user_id", CAST("created_at" AS TIMESTAMP) AS "created_at" FROM (SELECT "account_id" AS "account_id", "account_type" AS "account_type", "balance" AS "balance", "currency" AS "currency", "status" AS "status", "user_id" AS "user_id", "created_at" AS "created_at" FROM "database"."main"."accounts" AS "accounts") AS "_subquery" (base.py:2087)
2025-02-21 18:31:12,208 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (2025-02-20 00:00:00, 2025-02-21 00:00:00) for snapshot SnapshotId<"database"."main"."raw_accounts": 4252167850> (engine_adapter.py:1031)
2025-02-21 18:31:12,216 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:280)
2025-02-21 18:31:12,227 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Pausing snapshot SnapshotId<"database"."main"."raw_accounts": 2960047951> (engine_adapter.py:486)
2025-02-21 18:31:12,227 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"database"."main"."raw_accounts": 4252167850> (engine_adapter.py:457)
2025-02-21 18:31:12,231 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'database.main' (evaluator.py:1060)
2025-02-21 18:31:12,231 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "database"."main" (base.py:2087)
2025-02-21 18:31:12,231 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'database.main.raw_accounts' to point at table 'database.sqlmesh__main.main__raw_accounts__3546263750' (evaluator.py:1367)
2025-02-21 18:31:12,232 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "database"."main"."raw_accounts" AS SELECT * FROM "database"."sqlmesh__main"."main__raw_accounts__3546263750" (base.py:2087)
2025-02-21 18:31:12,233 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:405)
2025-02-21 18:31:12,262 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
