2025-02-21 18:22:19,698 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'database.duckdb'} (connection.py:309)
2025-02-21 18:22:20,079 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:311)
2025-02-21 18:22:20,096 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: database.duckdb (connection.py:305)
2025-02-21 18:22:24,105 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema database.sqlmesh__main (evaluator.py:322)
2025-02-21 18:22:24,106 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2087)
2025-02-21 18:22:24,107 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2087)
2025-02-21 18:22:24,109 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'database' AND table_schema = 'sqlmesh__main') AND table_name IN ('main__raw_accounts__3546263750') (base.py:2087)
2025-02-21 18:22:24,137 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema database.sqlmesh__sqlmesh_example (evaluator.py:322)
2025-02-21 18:22:24,137 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2087)
2025-02-21 18:22:24,137 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2087)
2025-02-21 18:22:24,138 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'database' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__3362895704', 'sqlmesh_example__seed_model__2185867172', 'sqlmesh_example__incremental_model__1127904061') (base.py:2087)
2025-02-21 18:22:24,145 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'database.sqlmesh__main' (evaluator.py:1060)
2025-02-21 18:22:24,145 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "database"."sqlmesh__main" (base.py:2087)
2025-02-21 18:22:24,146 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'database.sqlmesh__sqlmesh_example' (evaluator.py:1060)
2025-02-21 18:22:24,146 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "database"."sqlmesh__sqlmesh_example" (base.py:2087)
2025-02-21 18:22:24,149 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'database.sqlmesh__main.main__raw_accounts__3546263750' (evaluator.py:1402)
2025-02-21 18:22:24,150 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "database"."sqlmesh__main"."main__raw_accounts__3546263750" AS SELECT "account_id" AS "account_id", "account_type" AS "account_type", "balance" AS "balance", "currency" AS "currency", "status" AS "status", "user_id" AS "user_id", "created_at" AS "created_at" FROM "database"."main"."accounts" AS "accounts" WHERE FALSE LIMIT 0 (base.py:2087)
2025-02-21 18:22:24,163 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:280)
2025-02-21 18:22:24,173 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"database"."main"."raw_accounts": 2960047951> (engine_adapter.py:457)
2025-02-21 18:22:24,176 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'database.main' (evaluator.py:1060)
2025-02-21 18:22:24,176 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "database"."main" (base.py:2087)
2025-02-21 18:22:24,177 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'database.main.raw_accounts' to point at table 'database.sqlmesh__main.main__raw_accounts__3546263750' (evaluator.py:1367)
2025-02-21 18:22:24,177 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "database"."main"."raw_accounts" AS SELECT * FROM "database"."sqlmesh__main"."main__raw_accounts__3546263750" (base.py:2087)
2025-02-21 18:22:24,178 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:405)
2025-02-21 18:22:24,202 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
